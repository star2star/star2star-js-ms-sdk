"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

require("core-js/modules/es6.array.copy-within");

require("core-js/modules/es6.array.every");

require("core-js/modules/es6.array.fill");

require("core-js/modules/es6.array.filter");

require("core-js/modules/es6.array.find");

require("core-js/modules/es6.array.find-index");

require("core-js/modules/es6.array.for-each");

require("core-js/modules/es6.array.from");

require("core-js/modules/es7.array.includes");

require("core-js/modules/es6.array.index-of");

require("core-js/modules/es6.array.is-array");

require("core-js/modules/es6.array.iterator");

require("core-js/modules/es6.array.last-index-of");

require("core-js/modules/es6.array.map");

require("core-js/modules/es6.array.of");

require("core-js/modules/es6.array.reduce");

require("core-js/modules/es6.array.reduce-right");

require("core-js/modules/es6.array.some");

require("core-js/modules/es6.array.sort");

require("core-js/modules/es6.array.species");

require("core-js/modules/es6.date.now");

require("core-js/modules/es6.date.to-iso-string");

require("core-js/modules/es6.date.to-json");

require("core-js/modules/es6.date.to-primitive");

require("core-js/modules/es6.date.to-string");

require("core-js/modules/es6.function.bind");

require("core-js/modules/es6.function.has-instance");

require("core-js/modules/es6.function.name");

require("core-js/modules/es6.map");

require("core-js/modules/es6.math.acosh");

require("core-js/modules/es6.math.asinh");

require("core-js/modules/es6.math.atanh");

require("core-js/modules/es6.math.cbrt");

require("core-js/modules/es6.math.clz32");

require("core-js/modules/es6.math.cosh");

require("core-js/modules/es6.math.expm1");

require("core-js/modules/es6.math.fround");

require("core-js/modules/es6.math.hypot");

require("core-js/modules/es6.math.imul");

require("core-js/modules/es6.math.log1p");

require("core-js/modules/es6.math.log10");

require("core-js/modules/es6.math.log2");

require("core-js/modules/es6.math.sign");

require("core-js/modules/es6.math.sinh");

require("core-js/modules/es6.math.tanh");

require("core-js/modules/es6.math.trunc");

require("core-js/modules/es6.number.constructor");

require("core-js/modules/es6.number.epsilon");

require("core-js/modules/es6.number.is-finite");

require("core-js/modules/es6.number.is-integer");

require("core-js/modules/es6.number.is-nan");

require("core-js/modules/es6.number.is-safe-integer");

require("core-js/modules/es6.number.max-safe-integer");

require("core-js/modules/es6.number.min-safe-integer");

require("core-js/modules/es6.number.parse-float");

require("core-js/modules/es6.number.parse-int");

require("core-js/modules/es6.object.assign");

require("core-js/modules/es6.object.create");

require("core-js/modules/es7.object.define-getter");

require("core-js/modules/es7.object.define-setter");

require("core-js/modules/es6.object.define-property");

require("core-js/modules/es6.object.define-properties");

require("core-js/modules/es7.object.entries");

require("core-js/modules/es6.object.freeze");

require("core-js/modules/es6.object.get-own-property-descriptor");

require("core-js/modules/es7.object.get-own-property-descriptors");

require("core-js/modules/es6.object.get-own-property-names");

require("core-js/modules/es6.object.get-prototype-of");

require("core-js/modules/es7.object.lookup-getter");

require("core-js/modules/es7.object.lookup-setter");

require("core-js/modules/es6.object.prevent-extensions");

require("core-js/modules/es6.object.is");

require("core-js/modules/es6.object.is-frozen");

require("core-js/modules/es6.object.is-sealed");

require("core-js/modules/es6.object.is-extensible");

require("core-js/modules/es6.object.keys");

require("core-js/modules/es6.object.seal");

require("core-js/modules/es6.object.set-prototype-of");

require("core-js/modules/es7.object.values");

require("core-js/modules/es6.promise");

require("core-js/modules/es7.promise.finally");

require("core-js/modules/es6.reflect.apply");

require("core-js/modules/es6.reflect.construct");

require("core-js/modules/es6.reflect.define-property");

require("core-js/modules/es6.reflect.delete-property");

require("core-js/modules/es6.reflect.get");

require("core-js/modules/es6.reflect.get-own-property-descriptor");

require("core-js/modules/es6.reflect.get-prototype-of");

require("core-js/modules/es6.reflect.has");

require("core-js/modules/es6.reflect.is-extensible");

require("core-js/modules/es6.reflect.own-keys");

require("core-js/modules/es6.reflect.prevent-extensions");

require("core-js/modules/es6.reflect.set");

require("core-js/modules/es6.reflect.set-prototype-of");

require("core-js/modules/es6.regexp.constructor");

require("core-js/modules/es6.regexp.flags");

require("core-js/modules/es6.regexp.match");

require("core-js/modules/es6.regexp.replace");

require("core-js/modules/es6.regexp.split");

require("core-js/modules/es6.regexp.search");

require("core-js/modules/es6.regexp.to-string");

require("core-js/modules/es6.set");

require("core-js/modules/es6.symbol");

require("core-js/modules/es7.symbol.async-iterator");

require("core-js/modules/es6.string.anchor");

require("core-js/modules/es6.string.big");

require("core-js/modules/es6.string.blink");

require("core-js/modules/es6.string.bold");

require("core-js/modules/es6.string.code-point-at");

require("core-js/modules/es6.string.ends-with");

require("core-js/modules/es6.string.fixed");

require("core-js/modules/es6.string.fontcolor");

require("core-js/modules/es6.string.fontsize");

require("core-js/modules/es6.string.from-code-point");

require("core-js/modules/es6.string.includes");

require("core-js/modules/es6.string.italics");

require("core-js/modules/es6.string.iterator");

require("core-js/modules/es6.string.link");

require("core-js/modules/es7.string.pad-start");

require("core-js/modules/es7.string.pad-end");

require("core-js/modules/es6.string.raw");

require("core-js/modules/es6.string.repeat");

require("core-js/modules/es6.string.small");

require("core-js/modules/es6.string.starts-with");

require("core-js/modules/es6.string.strike");

require("core-js/modules/es6.string.sub");

require("core-js/modules/es6.string.sup");

require("core-js/modules/es6.string.trim");

require("core-js/modules/es6.typed.array-buffer");

require("core-js/modules/es6.typed.data-view");

require("core-js/modules/es6.typed.int8-array");

require("core-js/modules/es6.typed.uint8-array");

require("core-js/modules/es6.typed.uint8-clamped-array");

require("core-js/modules/es6.typed.int16-array");

require("core-js/modules/es6.typed.uint16-array");

require("core-js/modules/es6.typed.int32-array");

require("core-js/modules/es6.typed.uint32-array");

require("core-js/modules/es6.typed.float32-array");

require("core-js/modules/es6.typed.float64-array");

require("core-js/modules/es6.weak-map");

require("core-js/modules/es6.weak-set");

require("core-js/modules/web.timers");

require("core-js/modules/web.immediate");

require("core-js/modules/web.dom.iterable");

require("regenerator-runtime/runtime");

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

var winston = require('winston');

var Logger =
/*#__PURE__*/
function () {
  function Logger() {
    _classCallCheck(this, Logger);

    this.logger = new winston.Logger({
      levels: {
        error: 0,
        trace: 1,
        info: 2,
        debug: 3
      },
      transports: [new winston.transports.Console({
        level: 'trace',
        formatter: function formatter(options) {
          var loggerID;
          var loggerTrace;
          var loggerParent;
          var loggedMessageJSON = {};

          if (options.meta && options.meta.hasOwnProperty('id')) {
            loggerID = options.meta.id;
            delete options.meta.id;
          }

          if (options.meta && options.meta.hasOwnProperty('trace')) {
            loggerTrace = options.meta.trace;
            delete options.meta.trace;
          }

          if (options.meta && options.meta.hasOwnProperty('parent')) {
            loggerParent = options.meta.parent;
            delete options.meta.parent;
          } //stipping bearer tokens from logs for security


          if (options.meta && options.meta.hasOwnProperty("Authorization")) {
            delete options.meta.Authorization;
          }

          loggedMessageJSON.level = options.level;
          loggedMessageJSON.message = options.message;
          loggedMessageJSON.application = "s2sMsSDK";
          loggedMessageJSON.timestamp = new Date(Date.now()).toISOString();

          if (options.meta && JSON.stringify(options.meta) !== '{}') {
            loggedMessageJSON.metadata = options.meta;
          }

          if (loggerID) {
            loggedMessageJSON.id = loggerID;
          }

          if (loggerTrace) {
            loggedMessageJSON.trace = loggerTrace;
          }

          if (loggerParent) {
            loggedMessageJSON.parent = loggerParent;
          }

          if (this.prettyPrint) {
            return JSON.stringify(loggedMessageJSON, null, "\t");
          } else {
            return JSON.stringify(loggedMessageJSON);
          }
        }
      })]
    });
    return this;
  }

  _createClass(Logger, [{
    key: "setLevel",
    value: function setLevel(aLevel) {
      var validatedLevel;

      switch (aLevel) {
        case "error":
        case "info":
        case "debug":
        case "trace":
          validatedLevel = aLevel;
          break;

        default:
          validatedLevel = "silent";
      }

      this.logger.transports.console.level = validatedLevel;
    }
  }, {
    key: "setPretty",
    value: function setPretty(pretty) {
      if (pretty) {
        this.logger.transports.console.prettyPrint = true;
      } else {
        this.logger.transports.console.prettyPrint = false;
      }
    } //This function takes in an arguments object. It will serperatie out the first argument given. The first argument provided is the message title.

  }, {
    key: "getMessage",
    value: function getMessage(a) {
      return a && a.length > 0 ? a[0] : "default message";
    } //This function takes in an arguments object.
    //It will use these arguments to determine what the metadata is.

  }, {
    key: "getMeta",
    value: function getMeta(a) {
      var meta; //If there is only 1 argument that mean no metadata was passed in.

      if (a && a.length > 1) {
        //this code will run the splice and reduce functions on the arguments object as if it was an array
        //This code will add a new attribute to an empty object. This attribute will have the index of the argument as its' key.
        meta = [].slice.call(a, 1).reduce(function (p, c, i) {
          if (_typeof(c) === 'object') {
            p = _objectSpread({}, p, c);
          } else {
            p[i] = c;
          }

          return p;
        }, {});
      }

      return meta;
    }
  }, {
    key: "error",
    value: function error() {
      var msg = this.getMessage(arguments);
      var meta = this.getMeta(arguments);
      this.log('error', msg, meta);
    }
  }, {
    key: "info",
    value: function info() {
      var msg = this.getMessage(arguments);
      var meta = this.getMeta(arguments);
      this.log('info', msg, meta);
    }
  }, {
    key: "debug",
    value: function debug() {
      var msg = this.getMessage(arguments);
      var meta = this.getMeta(arguments);
      this.log('debug', msg, meta);
    }
  }, {
    key: "trace",
    value: function trace() {
      var msg = this.getMessage(arguments);
      var meta = this.getMeta(arguments);
      this.log('trace', msg, meta);
    }
  }, {
    key: "log",
    value: function log(aLevel, aMsg, aMeta) {
      var newLevel = aLevel;
      var newMeta = aMeta ? aMeta : {};
      newMeta.level = aLevel; //If the maeta data has the property debug set as true the level of the log will be changed to trace

      if (aMeta && aMeta.hasOwnProperty('debug') && aMeta.debug === true) {
        newLevel = 'trace';
      }

      this.logger.log(newLevel, aMsg, newMeta);
    }
  }]);

  return Logger;
}();

exports.default = Logger;